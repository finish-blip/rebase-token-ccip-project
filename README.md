# Rebase Token é¡¹ç›® README

## ğŸ“Œ é¡¹ç›®ç®€ä»‹

Rebase Token æ˜¯ä¸€ä¸ªåŸºäº Solidity ç¼–å†™çš„è·¨é“¾å¯æ‰©å±•ä»£å¸é¡¹ç›®ï¼Œæ”¯æŒä¾›åº”é‡éšæ—¶é—´åŠ¨æ€å¢é•¿ï¼ˆRebase æœºåˆ¶ï¼‰ã€‚è¯¥é¡¹ç›®é€šå¸¸ä¸ Vault åˆçº¦é…åˆä½¿ç”¨ï¼Œé€šè¿‡ç”¨æˆ·å­˜å…¥ ETH è·å– Rebase Tokenï¼Œå¹¶éšæ—¶é—´è·å¾—çº¿æ€§åˆ©æ¯æ”¶ç›Šã€‚

é¡¹ç›®ä¸»è¦åŒ…å«ï¼š

* **RebaseToken åˆçº¦**ï¼šè´Ÿè´£ä»£å¸å‘è¡Œã€ç‡ƒçƒ§ã€Rebase æ›´æ–°ç­‰é€»è¾‘ã€‚
* **Vault åˆçº¦**ï¼šè´Ÿè´£ç”¨æˆ·å­˜æ¬¾ã€èµå›ã€è®¡ç®—åˆ©æ¯å¹¶ä¸ RebaseToken äº¤äº’ã€‚
* **æµ‹è¯•ç”¨ä¾‹**ï¼šä½¿ç”¨ Foundryï¼ˆforgeï¼‰ç¼–å†™çš„å•å…ƒæµ‹è¯•ã€‚

è¯¥ README å°†å¸®åŠ©ä½ ç†è§£é¡¹ç›®ç»“æ„ã€éƒ¨ç½²æ–¹å¼åŠæµ‹è¯•æ–¹æ³•ã€‚

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
â”œâ”€â”€ src
â”‚   â”œâ”€â”€ RebaseToken.sol        # Rebase Token æ ¸å¿ƒæ™ºèƒ½åˆçº¦
â”‚   â””â”€â”€ Vault.sol              # å­˜å–æ¬¾ã€åˆ©æ¯é€»è¾‘åˆçº¦
â”œâ”€â”€ test
â”‚   â”œâ”€â”€ RebaseToken.t.sol      # RebaseToken å•æµ‹
â”‚   â””â”€â”€ Vault.t.sol            # Vault å•æµ‹
â”œâ”€â”€ foundry.toml               # Foundry é…ç½®æ–‡ä»¶
â””â”€â”€ README.md                  # é¡¹ç›®è¯´æ˜
```

---

## ğŸš€ åŠŸèƒ½è¯´æ˜

### ### 1. **RebaseToken åˆçº¦**

* åŸºäº ERC20
* å…·æœ‰ **åŠ¨æ€ä¾›åº”é‡å¢é•¿æœºåˆ¶ï¼ˆRebaseï¼‰**
* æ”¯æŒ mintã€burn
* ä½¿ç”¨ AccessControl ç®¡ç†æƒé™ï¼š

  * `DEFAULT_ADMIN_ROLE`
  * `MINTER_ROLE`
  * `REBASE_ROLE`

#### â­ Rebase æœºåˆ¶

Rebaseï¼šæ ¹æ® Vault ä¸­çš„åˆ©æ¯æ›´æ–°ä»£å¸ä½™é¢ï¼Œä½¿æ‰€æœ‰ç”¨æˆ·ä½™é¢ç­‰æ¯”ä¾‹å¢åŠ ã€‚

---

### 2. **Vault åˆçº¦**

* ç”¨æˆ·å­˜ ETH â†’ è·å¾—ç­‰å€¼ RebaseToken
* éšæ—¶é—´è‡ªåŠ¨äº§ç”Ÿçº¿æ€§åˆ©æ¯ï¼ˆå¦‚å¹´åŒ–åˆ©ç‡/æŒ‰ç§’å¢é•¿ï¼‰
* ç”¨æˆ·èµå›æ—¶ï¼š

  * é”€æ¯ RebaseToken
  * è¿”è¿˜åŸ ETHï¼ˆé€šå¸¸ä¸è¿”è¿˜åˆ©æ¯ï¼Œå› ä¸ºåˆ©æ¯å·²é€šè¿‡ Rebase åˆ†é…ï¼‰

---

## âš™ï¸ å®‰è£…å’Œç¯å¢ƒè¦æ±‚

### 1. å®‰è£… Foundry

```bash
curl -L https://foundry.paradigm.xyz | bash
foundryup
```

### 2. å®‰è£…ä¾èµ–

```bash
forge install openzeppelin/openzeppelin-contracts@v5.1.0
```

---

## ğŸ› ï¸ ç¼–è¯‘é¡¹ç›®

```bash
forge build
```

---

## ğŸ§ª è¿è¡Œæµ‹è¯•

é¡¹ç›®åŒ…å«å®Œæ•´çš„å•å…ƒæµ‹è¯•ï¼ŒåŒ…æ‹¬ï¼š

* å­˜æ¬¾æµç¨‹
* èµå›æµç¨‹
* Rebase æ›´æ–°
* æƒé™æ§åˆ¶æµ‹è¯•
* æ—¶é—´æ—…è¡Œï¼ˆwarpï¼‰åçš„ä½™é¢å¢é•¿æµ‹è¯•

è¿è¡Œå…¨éƒ¨æµ‹è¯•ï¼š

```bash
forge test -vvv
```

åªè¿è¡ŒæŸä¸ªæµ‹è¯•ï¼š

```bash
forge test --match-test testTransfer -vvv
```

---

## ğŸ“ ç¤ºä¾‹ï¼šæµ‹è¯•åˆ©æ¯å¢é•¿

ä»¥ä¸‹æµ‹è¯•å±•ç¤ºäº†ï¼š

1. ç”¨æˆ·å­˜æ¬¾
2. Warp å¿«è¿›æ—¶é—´
3. éªŒè¯ RebaseToken ä½™é¢æ˜¯å¦å¢é•¿

```solidity
vm.prank(user);
vm.deal(user, 10 ether);
vault.deposit{value: 10 ether}();

vm.warp(block.timestamp + 365 days);

uint256 balance = rebaseToken.balanceOf(user);
assertGt(balance, 10 ether);
```

---

## ğŸŒ éƒ¨ç½²åˆ°æœ¬åœ°é“¾ï¼ˆAnvilï¼‰

å¯åŠ¨æœ¬åœ°èŠ‚ç‚¹ï¼š

```bash
anvil
```

éƒ¨ç½²ï¼š

```bash
forge create --rpc-url http://127.0.0.1:8545 \
  --private-key <ä½ çš„ç§é’¥> \
  src/Vault.sol:Vault
```

---

## â— å¸¸è§é—®é¢˜

### 1. `AccessControlUnauthorizedAccount` é”™è¯¯

åŸå› ï¼šè°ƒç”¨æ–¹æ²¡æœ‰æƒé™ï¼Œä¾‹å¦‚ Mintã€Rebase éœ€è¦ç‰¹æ®Šè§’è‰²ã€‚
è§£å†³ï¼š

```solidity
rebaseToken.grantRole(REBASE_ROLE, address(vault));
```

### 2. Rebase ä¹‹åæ€»ä¾›åº”é‡ä¸æ­£ç¡®

ç¡®è®¤ï¼š

* Vault ä¸­çš„åˆ©æ¯é€»è¾‘æ˜¯å¦æ­£ç¡®
* Rebase æ˜¯å¦æŒ‰æ¯”ä¾‹æ›´æ–°æ‰€æœ‰ä½™é¢

### 3. redeem ä¸è¿”è¿˜åˆ©æ¯ï¼Ÿ

æ˜¯æ­£å¸¸ç°è±¡ï¼Œå› ä¸ºåˆ©æ¯é€šè¿‡ **Rebase å¢åŠ ä½™é¢** å·²ç»å‘æ”¾ã€‚



Rebase Token éœ€è¦è‡ªå®šä¹‰ TokenPool çš„åŸå› æ˜¯ï¼š
åœ¨è·¨é“¾è½¬ç§» Token æ—¶å¿…é¡»ä¼ é€’ç”¨æˆ·ä¸ªä½“åˆ©ç‡ï¼ˆinterestRateï¼‰ï¼Œå¦åˆ™åˆ©æ¯æœºåˆ¶ä¼šæ–­é“¾ï¼Œå¯¼è‡´ç”¨æˆ·èµ„äº§ä¸ä¸€è‡´ã€‚
âœ” åœ¨æºé“¾
Lock/Burn token
è¯»å–ç”¨æˆ·åˆ©ç‡
è·¨é“¾å‘é€åˆ©ç‡

âœ” åœ¨ç›®æ ‡é“¾
è§£ç åˆ©ç‡
Mint token ç»™ç”¨æˆ·
ç»§ç»­ç”¨åŒä¸€ä¸ªåˆ©ç‡è®¡ç®—åˆ©æ¯å¢é•¿

ä¿è¯ç”¨æˆ·èµ„äº§åœ¨æ‰€æœ‰é“¾ä¸Šçš„åˆ©æ¯ä¿æŒè¿ç»­ä¸€è‡´ã€‚

è·¨é“¾æ—¶ç”¨æˆ·çš„ä¸ªäººåˆ©ç‡ï¼ˆinterestRateï¼‰å¿…é¡»å¸¦è¿‡å»ï¼Œä¸éšé“¾çš„ APR å˜åŒ–ã€‚

ä¸èƒ½è·¨é“¾å¸¦å·²è·å¾—çš„åˆ©æ¯ï¼Œå› ä¸ºè¿™ä¼šå¯¼è‡´å¥—åˆ©æ”»å‡»ã€‚

æ¯æ¡é“¾ä¸Šçš„ APRï¼ˆç³»ç»Ÿåˆ©ç‡ï¼‰æ˜¯ç‹¬ç«‹çš„ï¼Œä¸ä¼šè·¨é“¾ä¼ é€’ã€‚

å•ç‹¬æµ‹è¯•çš„å‘½ä»¤ï¼š
forge test --match-test testCannotCallMintAndBurn -vvv
